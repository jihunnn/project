<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.member">

	<resultMap id="memResult" type="memberVO">
		<result property="memId" column="memId" />
		<result property="memName" column="memName" />
		<result property="memPwd" column="memPwd" />
		<result property="memEmail" column="memEmail" />
		<result property="memPhoneNum" column="memPhoneNum" />
		<result property="memAdr" column="memAdr" />
	</resultMap>


	<!-- 회원리스트 조회 -->
	<select id="selectAllMemberList" resultMap="memResult">
	<![CDATA[
		select * from t_member order by joinDate desc
	]]>
	</select>

	<!-- 일반회원가입 -->
	<insert id="insertMember" parameterType="memberVO">
		<![CDATA[ 



			insert into simple.member(memId, memName, memPwd, memEmail, memPhoneNum, memAdr, logintype) 
			values(#{memId},#{memName},#{memPwd},(select concat_ws('@',#{memEmail},#{memEmail1})),(select concat_ws('-',#{memPhoneNum},#{memPhoneNum1},#{memPhoneNum2})),(select concat_ws('-',#{memAdr},#{memAdr1},#{memAdr2})),"일반");

		]]>
	</insert>

	<!-- 네이버아이디로로그인 후 추가정보기입 -->
	<insert id="insertMember_naver" parameterType="memberVO">
		<![CDATA[ 

			insert into simple.member(memId, memName, memPwd, memEmail, memPhoneNum, memAdr, logintype) 
			values(#{memId},#{memName},#{memPwd},(select concat_ws('@',#{memEmail},#{memEmail1})),(select concat_ws('-',#{memPhoneNum},#{memPhoneNum1},#{memPhoneNum2})),(select concat_ws('-',#{memAdr},#{memAdr1},#{memAdr2})),"네이버");
		]]>
	</insert>

	<!--DB에있는 네이버아이디정보로로그인(네이버로그인) -->
	<select id="loginBynaver" resultType="memberVO" parameterType="memberVO">
		<![CDATA[ 

		select * from member
		where memId = #{memId}
		]]>
	</select>



	<!--로그인창에서 입력한 id와 비밀번호로 회원정보를 조회하는 sql문 -->
	<select id="loginById" resultType="memberVO"
		parameterType="memberVO">
	<![CDATA[ 
		select * from member
		where memId = #{memId} and memPwd = #{memPwd}
	]]>
	</select>



	<!-- 회원정보수정 -->
	<update id="updateMember" parameterType="MemberVO">
	<![CDATA[ 
		update simple.member
		set memPwd = #{memPwd}, memEmail=(select concat_ws('@',#{memEmail},#{memEmail1})), memPhoneNum=(select concat_ws('-',#{memPhoneNum},#{memPhoneNum1},#{memPhoneNum2})), memAdr=(select concat_ws('-',#{memAdr},#{memAdr1},#{memAdr2})) where memId=#{memId} 
	]]>
	</update>


	<!-- 회원탈퇴 -->
	<delete id="deleteMember" parameterType="MemberVO">
	<![CDATA[
	   delete from  member
	   where
	   memId=#{memId} and memPwd=#{memPwd}
	]]>
	</delete>

</mapper>
		
		